{"version":3,"file":"index.a0b960ef.js","sources":["../../vite/modulepreload-polyfill","../../../../../@vite-plugin-pwa/virtual:pwa-register/react","../../src/ReloadPrompt.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","// src/client/build/react.ts\nimport { useState } from \"react\";\n\n// src/client/build/register.ts\nimport { Workbox, messageSW } from \"workbox-window\";\nvar autoUpdateMode = \"false\";\nvar auto = autoUpdateMode === \"true\";\nfunction registerSW(options = {}) {\n  const {\n    immediate = false,\n    onNeedRefresh,\n    onOfflineReady,\n    onRegistered,\n    onRegisterError\n  } = options;\n  let wb;\n  let registration;\n  const updateServiceWorker = async (reloadPage = true) => {\n    if (!auto) {\n      if (reloadPage) {\n        wb == null ? void 0 : wb.addEventListener(\"controlling\", (event) => {\n          if (event.isUpdate)\n            window.location.reload();\n        });\n      }\n      if (registration && registration.waiting) {\n        await messageSW(registration.waiting, { type: \"SKIP_WAITING\" });\n      }\n    }\n  };\n  if (\"serviceWorker\" in navigator) {\n    wb = new Workbox(\"/vite-react-service-worker/sw.js\", { scope: \"/vite-react-service-worker/\", type: \"classic\" });\n    wb.addEventListener(\"activated\", (event) => {\n      if (event.isUpdate)\n        auto && window.location.reload();\n      else\n        onOfflineReady == null ? void 0 : onOfflineReady();\n    });\n    if (!auto) {\n      const showSkipWaitingPrompt = () => {\n        onNeedRefresh == null ? void 0 : onNeedRefresh();\n      };\n      wb.addEventListener(\"waiting\", showSkipWaitingPrompt);\n      wb.addEventListener(\"externalwaiting\", showSkipWaitingPrompt);\n    }\n    wb.register({ immediate }).then((r) => {\n      registration = r;\n      onRegistered == null ? void 0 : onRegistered(r);\n    }).catch((e) => {\n      onRegisterError == null ? void 0 : onRegisterError(e);\n    });\n  }\n  return updateServiceWorker;\n}\n\n// src/client/build/react.ts\nfunction useRegisterSW(options = {}) {\n  const {\n    immediate = true,\n    onNeedRefresh,\n    onOfflineReady,\n    onRegistered,\n    onRegisterError\n  } = options;\n  const [needRefresh, setNeedRefresh] = useState(false);\n  const [offlineReady, setOfflineReady] = useState(false);\n  const [updateServiceWorker] = useState(() => {\n    return registerSW({\n      immediate,\n      onOfflineReady() {\n        setOfflineReady(true);\n        onOfflineReady == null ? void 0 : onOfflineReady();\n      },\n      onNeedRefresh() {\n        setNeedRefresh(true);\n        onNeedRefresh == null ? void 0 : onNeedRefresh();\n      },\n      onRegistered,\n      onRegisterError\n    });\n  });\n  return {\n    needRefresh: [needRefresh, setNeedRefresh],\n    offlineReady: [offlineReady, setOfflineReady],\n    updateServiceWorker\n  };\n}\nexport {\n  useRegisterSW\n};\n","// eslint-disable-next-line no-use-before-define\nimport React from 'react'\nimport './ReloadPrompt.css'\n\nimport { useRegisterSW } from 'virtual:pwa-register/react'\n\nfunction ReloadPrompt() {\n  // replaced dynamically\n  const buildDate = '__DATE__'\n  // replaced dyanmicaly\n  const reloadSW = '__RELOAD_SW__'\n\n  const {\n    offlineReady: [offlineReady, setOfflineReady],\n    needRefresh: [needRefresh, setNeedRefresh],\n    updateServiceWorker,\n  } = useRegisterSW({\n    onRegistered(r) {\n      // @ts-ignore\n      if (reloadSW === 'true') {\n        r && setInterval(() => {\n          console.log('Checking for sw update')\n          r.update()\n        }, 20000 /* 20s for testing purposes */)\n      }\n      else {\n        // eslint-disable-next-line prefer-template\n        console.log('SW Registered: ' + r)\n      }\n    },\n    onRegisterError(error) {\n      console.log('SW registration error', error)\n    },\n  })\n\n  const close = () => {\n    setOfflineReady(false)\n    setNeedRefresh(false)\n  }\n\n  return (\n    <div className=\"ReloadPrompt-container\">\n      { (offlineReady || needRefresh)\n          && <div className=\"ReloadPrompt-toast\">\n            <div className=\"ReloadPrompt-message\">\n              { offlineReady\n                ? <span>App ready to work offline</span>\n                : <span>New content available, click on reload button to update.</span>\n              }\n            </div>\n            { needRefresh && <button className=\"ReloadPrompt-toast-button\" onClick={() => updateServiceWorker(true)}>Reload</button> }\n            <button className=\"ReloadPrompt-toast-button\" onClick={() => close()}>Close</button>\n          </div>\n      }\n      <div className=\"ReloadPrompt-date\">{buildDate}</div>\n    </div>\n  )\n}\n\nexport default ReloadPrompt\n","// eslint-disable-next-line no-use-before-define\nimport React from 'react'\nimport { Outlet } from 'react-router-dom'\nimport ReloadPrompt from './ReloadPrompt'\nimport './App.css'\n\nfunction App() {\n  // replaced dyanmicaly\n  const date = '__DATE__'\n\n  return (\n    <main className=\"App\">\n      <img src=\"/vite-react-service-worker/favicon.svg\" alt=\"PWA Logo\" width=\"60\" height=\"60\" />\n      <h1 className=\"Home-title\">PWA React!</h1>\n      <div className=\"Home-built\">Built at: {date}</div>\n      <Outlet />\n      <ReloadPrompt />\n    </main>\n  )\n}\n\nexport default App\n","// eslint-disable-next-line no-use-before-define\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(\n  <App />,\n  document.getElementById('app'),\n)\n"],"names":["messageSW","Workbox","useState"],"mappings":"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"}